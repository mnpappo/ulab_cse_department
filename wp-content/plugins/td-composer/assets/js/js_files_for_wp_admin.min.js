var tdcNotice;
(function(b,c){tdcNotice={$_noticeWrapper:c,_isInitialized:!1,notice:function(a,d,c){if(tdcNotice._isInitialized){var e="";"undefined"!==typeof d&&!0===d&&(e="tdc-notice-error");var g="";"undefined"!==typeof c&&!0===c&&(g='<div class="tdc-close-notice"></div>');this.$element=b('<div class="tdc-notice '+e+'">'+a+g+"</div>");tdcNotice.$_noticeWrapper.append(this.$element);var h=this;if("undefined"!==typeof d&&!0===d)throw a;setTimeout(function(){h.$element.length&&h.$element.remove()},5E3)}},init:function(){tdcNotice._isInitialized||
(tdcNotice.$_noticeWrapper=b('<div class="tdc-notice-wrapper"></div>'),tdcNotice.$_noticeWrapper.on("click",".tdc-close-notice",function(a){b(this).closest(".tdc-notice").remove()}),b("#tdc-live-iframe-wrapper").append(tdcNotice.$_noticeWrapper),tdcNotice._isInitialized=!0)}};tdcNotice.init()})(jQuery);var tdcShortcodeParser={};
(function(){tdcShortcodeParser={levels:{},init:function(b){tdcShortcodeParser.levels=_.clone(b);tdcShortcodeParser.levels[2]=tdcShortcodeParser.levels[2].concat(tdcShortcodeParser.levels[4])},multiNext:function(b,c){for(var a=tdcShortcodeParser.levels[b],d,e=0;e<a.length;e++){var f=tdcShortcodeParser.generateTreeElement(wp.shortcode.next(a[e],c));"undefined"!==typeof f&&("undefined"===typeof d||d.index>f.index)&&(d=f)}return d},parse:function(b,c){for(var a=tdcShortcodeParser.multiNext(b,c),d=0,e=
[];"undefined"!==typeof a&&5E3>d;)c=c.substring(a.index+a.content.length),4>b&&(a.child=tdcShortcodeParser.parse(b+1,a.content)),e.push(a),a=tdcShortcodeParser.multiNext(b,c),d++;return e},generateTreeElement:function(b){return b}}})();var tdcInit={};
(function(b,c,a){tdcInit={$formPost:a,_title:"TagDiv Composer Draft",_url:"",$title:a,$titlePromptText:a,$contentWrap:a,$content:a,$contentIfr:a,$originalPostStatus:a,$_wpnonce:a,$postType:a,$postId:a,$postAuthor:a,$excerpt:a,$catslist:a,catslistValue:"",init:function(){tdcInit.$formPost=b("#post");tdcInit.$formPost.length&&(tdcInit.$title=tdcInit.$formPost.find("#title"),tdcInit.$titlePromptText=tdcInit.$formPost.find("#title-prompt-text"),tdcInit.$contentWrap=tdcInit.$formPost.find("#wp-content-wrap"),
tdcInit.$content=tdcInit.$formPost.find("#content"),tdcInit.$contentIfr=tdcInit.$formPost.find("#content_ifr"),tdcInit.$originalPostStatus=tdcInit.$formPost.find("#original_post_status"),tdcInit.$_wpnonce=tdcInit.$formPost.find("#_wpnonce"),tdcInit.$postType=tdcInit.$formPost.find("#post_type"),tdcInit.$postId=tdcInit.$formPost.find("#post_ID"),tdcInit.$postAuthor=tdcInit.$formPost.find("#post_author"),tdcInit.$excerpt=tdcInit.$formPost.find("#excerpt"),tdcInit.$catslist=tdcInit.$formPost.find("input[type=checkbox][name^=post_category]"),
c.each(tdcInit.$catslist,function(a,c,f){a=b(a);a.is(":checked")&&(tdcInit.catslistValue+=a.val()+",")}),tdcInit._url=window.tdcAdminSettings.adminUrl+"post.php?post_id="+tdcInit.$postId.val()+"&td_action=tdc","page"===tdcInit.$postType.val()&&b('<div class="tdc-panel-button"><div class="tdc-panel-icon"></div><div class="tdc-panel-link"><a onclick="return tdcInit.savePost( event )" href="'+tdcInit._url+'">TagDiv Composer</a></div></div>').insertAfter("div#titlediv"))},_checkPostContent:function(){tdcInit.$title.length&&
tdcInit.$titlePromptText.length&&0===tdcInit.$title.val().trim().length&&(tdcInit.$title.val(tdcInit._title),tdcInit.$titlePromptText.hide());tdcShortcodeParser.init({0:["vc_row"],1:["vc_column"],2:["vc_row_inner"],3:["vc_column_inner"],4:[]});return tdcInit.$contentWrap.hasClass("tmce-active")?tinyMCE.activeEditor.getContent():tdcInit.$formPost.find("#content").val()},savePost:function(a){b(".tdc-panel-button").addClass("tdc-open-editor-loader");setTimeout(function(){b(".tdc-panel-button").removeClass("tdc-open-editor-loader")},
2E3);a=tdcInit._checkPostContent();b.ajax({url:window.ajaxurl,type:"POST",data:{"data[wp_autosave][post_id]":tdcInit.$postId.val(),"data[wp_autosave][post_type]":tdcInit.$postType.val(),"data[wp_autosave][post_author]":tdcInit.$postAuthor.val(),"data[wp_autosave][post_title]":tdcInit.$title.val(),"data[wp_autosave][content]":a,"data[wp_autosave][excerpt]":tdcInit.$excerpt.val(),"data[wp_autosave][catslist]":tdcInit.catslistValue,"data[wp_autosave][auto_draft]":1,"data[wp_autosave][_wpnonce]":tdcInit.$_wpnonce.val(),
interval:60,_nonce:window.heartbeatSettings.nonce,action:"heartbeat",screen_id:tdcInit.$postType.val(),has_focus:!1}}).done(function(a,b,d){window.location=tdcInit._url});return!1}};b(window).ready(function(){tdcInit.init()})})(jQuery,_);var tdcDebug;
(function(b,c){tdcDebug={_debug:!0,_logWindowObj:c,_content:c,_disabled:!1,log:function(a){tdcDebug._debug&&console.log(a)},dumpAllItems:function(){var a=tdcAdminIFrameUI.getIframeWindow();console.group("All items dump:");"undefined"!==typeof a.tdcComposerBlocksApi&&(console.log("%c tdcComposerBlocksApi.items ","background: #222; color: white"),console.log(a.tdcComposerBlocksApi.items));"undefined"!==typeof a.tdPullDown&&(console.log("%c tdPullDown.items ","background: #222; color: white"),console.log(a.tdPullDown.items));
"undefined"!==typeof a.tdAnimationSprite&&(console.log("%c tdAnimationSprite.items ","background: #222; color: white"),console.log(a.tdAnimationSprite.items));"undefined"!==typeof a.tdHomepageFull&&(console.log("%c tdHomepageFull.items ","background: #222; color: white"),console.log(a.tdHomepageFull.items));"undefined"!==typeof a.tdTrendingNow&&(console.log("%c tdTrendingNow.items ","background: #222; color: white"),console.log(a.tdTrendingNow.items));console.groupEnd()},group:function(a,b){!1!==
tdcDebug._debug&&(console.group?console.group(a,b):console.log(a))},groupCollapsed:function(a,b){!1!==tdcDebug._debug&&(console.groupCollapsed?console.groupCollapsed(a,b):console.log(a))},groupEnd:function(){!1!==tdcDebug._debug&&console.groupEnd&&console.groupEnd()},logWindow:function(a){if(c===tdcDebug._logWindowObj){tdcDebug._logWindowObj=b("<div></div>");var d=b('<div style="width: 50px; cursor: pointer; float: left; border: 1px solid black">Clear</div>'),e=b('<div style="width: 50px; cursor: pointer; float: left; border: 1px solid black">Disable</div>');
tdcDebug._content=b('<div style="clear: both"></div>');tdcDebug._logWindowObj.append(d);tdcDebug._logWindowObj.append(e);d.click(function(a){tdcDebug._content.html("")});e.click(function(a){tdcDebug._disabled=!tdcDebug._disabled;tdcDebug._disabled?b(this).css("background-color","#FF000"):b(this).css("background-color","")});tdcDebug._logWindowObj.append(tdcDebug._content);b("body").append(tdcDebug._logWindowObj);tdcDebug._logWindowObj.css({width:300,height:500,border:"1px solid red",position:"fixed",
bottom:0,right:20,"background-color":"#FFFFFF",overflow:"scroll","z-index":1E4})}tdcDebug._disabled||tdcDebug._content.html(a+"<br>"+tdcDebug._content.html())}}})(jQuery);
